### babelçš„ä¸»è¦ä½¿ç”¨åœºæ™¯

- ES6çš„ä»£ç è½¬æ¢ä¸ºES5ä»£ç ï¼Œä½¿å¾—å¼€å‘å…¼å®¹åˆ°ç”Ÿäº§

- ES6æœ€æ–°çš„apiæ²¡æœ‰æ™®éæä¾›å®žçŽ°ï¼Œå€ŸåŠ©core-jsè‡ªåŠ¨ç»™jsä»£ç æ·»åŠ polyfillï¼Œä»¥ä¾¿æœ€ç»ˆç”Ÿäº§çŽ¯å¢ƒçš„ä»£ç èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨æ–°çš„apiï¼›babelå§‹ç»ˆèƒ½æä¾›å¯¹æœ€æ–°esææ¡ˆçš„æ”¯æŒ

- è§„èŒƒä»£ç é£Žæ ¼ï¼Œæé«˜ä»£ç è´¨é‡ï¼Œå€ŸåŠ©babelï¼Œå°†æºç åšæ ‡å‡†åŒ–è½¬æ¢å¤„ç†ï¼Œæå‡å¼€å‘è´¨é‡

- .vueæ–‡ä»¶ä¸Žjsxï¼Œæ­£ç¡®åœ°è½¬æ¢ä¸ºESä»£ç 

- å€ŸåŠ©å¼ºç±»åž‹è¯­è¨€é™æ€åˆ†æžèƒ½åŠ›ï¼Œå¯¹jsä»£ç åšä¸€äº›æ£€æŸ¥ï¼Œå°†flowå’Œtypescriptçš„ä»£ç ï¼Œè½¬æ¢ä¸ºæ ‡å‡†çš„ESä»£ç 

- ç”Ÿæˆä»£ç çš„sourcemapï¼Œä¾¿äºŽæŽ’æŸ¥ç‰¹æ®Šé—®é¢˜

- es6ç¼–å†™çš„modulesåœ¨è¢«requireçš„æ—¶å€™ï¼Œè‡ªåŠ¨è¿›è¡Œä»£ç è½¬æ¢

  

### babelç¼–è¯‘è¿‡ç¨‹

- parser(è§£æž)ï¼šé€šè¿‡[babylon](https://github.com/babel/babylon)è§£æžæˆ AST

- transform(è½¬æ¢)ï¼šè¿›ä¸€æ­¥çš„åšè¯­æ³•ç­‰è‡ªå®šä¹‰çš„è½¬è¯‘ï¼Œä»ç„¶æ˜¯ AST

- generator(ç”Ÿæˆ)ï¼šæœ€åŽé€šè¿‡ babel-generator ç”Ÿæˆ output string

  

  ![img](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9150bccc88ab45e48ab55af3089e2c1a~tplv-k3u1fbpfcp-zoom-1.image?imageslim)

  

  babylonå°†æºç è½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼›babel-traverseé€šè¿‡ASTç”Ÿæˆä¸€ä¸ªä¾¿äºŽæ“ä½œã€è½¬æ¢çš„pathå¯¹è±¡ï¼Œä¾›æˆ‘ä»¬çš„babelæ’ä»¶å¤„ç†ï¼›babel-generatorè¯»å–ASTå¹¶å°†å…¶è½¬æ¢ä¸ºä»£ç å’Œæºç æ˜ å°„ã€‚è¿™äº›è¿‡ç¨‹ä¸æ˜¯æœ¬æ–‡çš„å…³æ³¨ç‚¹ï¼Œæˆ‘ä»¬å…³æ³¨çš„æ˜¯ç»“æžœï¼Œå“ªäº›æ’ä»¶ä¸Žæˆ‘ä»¬çš„ç”Ÿäº§æ¯æ¯ç›¸å…³ï¼Œæˆ‘ä»¬å¦‚ä½•åŽ»ä½¿ç”¨babelçš„æ’ä»¶

  

### babelåŒ…

###  Plugin/Preset æŽ’åº

1. `Plugin`ä¼šè¿è¡Œåœ¨`Preset`ä¹‹å‰;

2. `Plugin`ä¼šä»Žç¬¬ä¸€ä¸ªå¼€å§‹é¡ºåºæ‰§è¡Œ;

   ```js
   {
     "plugins": [
       "transform-decorators-legacy",
       "transform-class-properties"
     ]
   }
   // å°†å…ˆæ‰§è¡Œ transform-decorators-legacy,å†æ‰§è¡Œ transform-class-properties
   ```

   

3. `Preset`çš„é¡ºåºåˆ™åˆšå¥½ç›¸å(ä»Žæœ€åŽä¸€ä¸ªé€†åºæ‰§è¡Œ)ã€‚

   ```js
   // ä¸€å®šè¦è®°å¾— preset çš„é¡ºåºæ˜¯åå‘çš„ã€‚ä¸¾ä¸ªä¾‹å­:
   
   {
     "presets": [
       "es2015",
       "react",
       "stage-0"
     ]
   }
   // æŒ‰ä»¥ä¸‹é¡ºåºè¿è¡Œ: stage-0ï¼Œreactï¼Œæœ€åŽes2015
   ```

   

### presetsé…ç½®é¡¹

##### babel-core

å¯ä»¥çœ‹åš babel çš„ç¼–è¯‘å™¨ï¼Œbabel çš„æ ¸å¿ƒ api éƒ½åœ¨è¿™é‡Œé¢ï¼Œæ¯”å¦‚ transformï¼Œä¸»è¦éƒ½æ˜¯å¤„ç†è½¬ç ã€‚å®ƒä¼šæŠŠ js ä»£ç æŠ½è±¡æˆ astï¼Œå³æºä»£ç çš„æŠ½è±¡è¯­æ³•ç»“æž„çš„æ ‘çŠ¶è¡¨çŽ°å½¢å¼ã€‚ es6 çš„æ–°è¯­æ³•ï¼Œå…ˆè½¬æˆ astï¼ŒåŽ»å‘çŽ°è¿™ä¸ªè¯­æ³•çš„ kindï¼Œåˆ†åˆ«åšå¯¹åº”çš„å¤„ç†è½¬åŒ–æˆ es5

```js
@babel/coreåŒ…å«çš„æ˜¯æ•´ä¸ªbabelå·¥ä½œæµï¼Œåœ¨å¼€å‘æ’ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æžœæ¯ä¸ªAPIéƒ½å•ç‹¬åŽ»å¼•å…¥å²‚ä¸æ˜¯è’™è”½äº†æ¥å§ï½žäºŽæ˜¯å°±æœ‰äº†@babel/coreæ’ä»¶ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯æ ¸å¿ƒæ’ä»¶ï¼Œä»–å°†åº•å±‚çš„æ’ä»¶è¿›è¡Œå°è£…ï¼ˆåŒ…å«äº†parserã€generatorç­‰ï¼‰ï¼Œæé«˜åŽŸæœ‰çš„æ’ä»¶å¼€å‘æ•ˆçŽ‡ï¼Œç®€åŒ–è¿‡ç¨‹ï¼Œå¥½ä¸€ä¸ªâ€œðŸŸè‚¯å¾·åŸºå…¨å®¶æ¡¶â€
```



##### babel-polyfill

Babelé»˜è®¤åªè½¬æ¢æ–°çš„JavaScriptå¥æ³•ï¼ˆsyntaxï¼‰ï¼Œä¸è½¬ç çš„APIéžå¸¸å¤šï¼Œæ¯”å¦‚Iteratorã€Generatorã€Setã€Mapsã€Proxyã€Reflectã€Symbolã€Promiseç­‰ã€‚ä¸ºå½“å‰çŽ¯å¢ƒæä¾›ä¸€ä¸ªåž«ç‰‡ï¼Œä»¥ç±»ä¼¼ Array.prototype.includes() çš„æ–¹å¼åŽ»æ³¨å…¥æ±¡æŸ“åŽŸåž‹ï¼Œæœ€é€‚åˆåº”ç”¨çº§å¼€å‘çš„ polyfillï¼Œå¼€å‘åº“çš„è¯ï¼Œä¸æŽ¨èä½¿ç”¨ï¼Œåœ¨7.xä¹‹å‰ç¼ºç‚¹ä¹Ÿæ˜¾è€Œæ˜“è§ï¼Œé‚£å°±æ˜¯å æ–‡ä»¶ç©ºé—´å¹¶ä¸”æ— æ³•æŒ‰éœ€å®šåˆ¶

ä½¿ç”¨æ–¹æ³•:

```shell
npm i @babel/polyfill -S
```

```js
//	ä½¿ç”¨æ–¹å¼äºŒè€…é€‰å…¶ä¸€

//	vue main.js
import "@babel/polyfill"

//	webpack.config.js
module.exports = {
    entry:["@babel/polyfill","main.js"]
}
```

ä¸Šé¢è¿™ä¸¤ç§æ–¹å¼æ˜¯å°†æ•´ä¸ªpolyfilléƒ½å¼•å…¥äº†ï¼Œå¾ˆå¤šä»£ç å…¶å®žå¯¹æˆ‘ä»¬æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬çš„envé…ç½®çš„æ˜¯ä¸éœ€è¦å…¼å®¹ie9ä»¥ä¸‹çš„æµè§ˆå™¨ï¼Œè¿™ç§å¼•å…¥æ–¹å¼æŠŠæ‰€æœ‰å…¼å®¹ieçš„ä»£ç éƒ½å¼•å…¥äº†ï¼ŒåŒ…å«ie8ä»¥ä¸‹ï¼Œæ‰€ä»¥ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šåœ¨`.babelrc`æ–‡ä»¶é‡Œçš„envé‡Œé…ç½®ä¸‹`useBuiltIns`å‚æ•°ï¼Œè¿™æ ·babelåœ¨å¼•å…¥çš„æ—¶å€™ä¼šæ ¹æ®æˆ‘ä»¬envçŽ¯å¢ƒåŽ»åŠ è½½ç›¸åº”çš„polyfill

å¦‚ä»¥ä¸‹ä¸¤ç§æ–¹å¼

- å¦‚æžœåœ¨ .babelrc ä¸­è®¾ç½® useBuiltIns: 'usage'ï¼Œåˆ™ä¸è¦åœ¨ webpack.config.js entry æ•°ç»„æˆ– æºç ä¸­åŒ…å« @babel/polyfillã€‚æ³¨æ„ï¼Œä»ç„¶éœ€è¦å®‰è£… babel-polyfillï¼ˆå°±æ˜¯è¯´ npm i -S @babel/polyfillåŽå°±ä¸ç®¡äº†ï¼‰ã€‚
- å¦‚æžœåœ¨ .babelrc ä¸­è®¾ç½® useBuiltIns: 'entry'ï¼Œåœ¨åº”ç”¨ç¨‹åºå…¥å£ï¼ˆmain.jsï¼‰çš„é¡¶éƒ¨å¼•å…¥ @babel/polyfillã€‚
- å¦‚æžœåœ¨ .babelrc ä¸­æ²¡æœ‰æ˜Žç¡®è®¾ç½®useBuiltInsçš„å€¼ï¼ˆå°±æ˜¯ä½ æ²¡æœ‰åŽ»é…ç½®è¿™é¡¹ï¼‰æˆ–è€…è®¾ç½®äº† useBuiltIns: falseï¼Œå°† @babel/polyfill æ·»åŠ åˆ° webpack.config.js çš„å…¥å£æ•°ç»„ä¸­ã€‚

```js
// .babelrc
{
  ["env", {
    "modules": false,
    "targets": {
      "browsers": ["> 1%", "last 2 versions", "not ie <= 8"]
    },
    // æ˜¯å¦è‡ªåŠ¨å¼•å…¥polyfillï¼Œå¼€å¯æ­¤é€‰é¡¹å¿…é¡»ä¿è¯å·²ç»å®‰è£…äº†babel-polyfill
    // åœ¨è¿™é‡Œè®¾ç½®è‡ªåŠ¨å¼•å…¥åŽï¼Œbabelä¼šæ ¹æ®ä½ é…ç½®çš„å…¼å®¹çš„çŽ¯å¢ƒï¼ŒåŽ»æŒ‰éœ€åŠ è½½polyfillçš„ä»£ç ï¼Œè¿™æ ·èƒ½ä¿è¯ä»£ç é‡æœ€å°‘
    // å‚æ•°ï¼šBooleanï¼Œé»˜è®¤ä¸ºfalse.
    "useBuiltIns": "usage"
  }]
}
// webpack.base.conf.js
module.exports = {
  entry: ["@babel/polyfill", "./main.js"],
};
```



##### babel-preset-env

æ ¹æ®è¿è¡ŒçŽ¯å¢ƒï¼Œè‡ªåŠ¨ç¡®å®šä½ éœ€è¦çš„ pulgins å’Œ polyfillsï¼Œ

```js
"presets": [
  [
    "env",
    {
      "modules": false, //è®¾ç½®ES6 æ¨¡å—è½¬è¯‘çš„æ¨¡å—æ ¼å¼ é»˜è®¤æ˜¯ commonjs
      "debug": true, // å¼€å¯debugåŽï¼Œç¼–è¯‘ç»“æžœä¼šå¾—åˆ°ä½¿ç”¨çš„ targetsï¼Œpluginsï¼Œpolyfill ç­‰ä¿¡æ¯
      "useBuiltIns": false, //æ˜¯å¦å¼€å¯è‡ªåŠ¨æ”¯æŒ polyfill
        /*
         entry: åŽ»æŽ‰ç›®æ ‡æµè§ˆå™¨å·²æ”¯æŒçš„polyfilll æ¨¡å—ï¼Œå°†æµè§ˆå™¨ä¸æ”¯æŒçš„éƒ½å¼•å…¥å¯¹åº”çš„polyfilll æ¨¡å—ã€‚

		usage: æ‰“åŒ…æ—¶ä¼šè‡ªåŠ¨æ ¹æ®å®žé™…ä»£ç çš„ä½¿ç”¨æƒ…å†µï¼Œç»“åˆ targets å¼•å…¥ä»£ç é‡Œå®žé™…ç”¨åˆ°éƒ¨åˆ† polyfilllæ¨¡å—

		false: ä¸ä¼šè‡ªåŠ¨å¼•å…¥ polyfilll æ¨¡å—ï¼Œå¯¹polyfilllæ¨¡å—å±è”½
        */
      "include": [], // æ€»æ˜¯å¯ç”¨å“ªäº› plugins
      "exclude": [], //å¼ºåˆ¶ä¸å¯ç”¨å“ªäº› pluginsï¼Œç”¨æ¥é˜²æ­¢æŸäº›æ’ä»¶è¢«å¯ç”¨
      "targets": [	//	é…æ”¯æŒçš„çŽ¯å¢ƒ
        "browers": ["last 2 versions", "not ie <= 9"]	//	å°±æ˜¯å‘Šè¯‰babelä½ çš„jsè¦å…¼å®¹å“ªäº›çŽ¯å¢ƒï¼Œå®ƒä¼šå¸®ä½ å°†ä½ å†™çš„jsè½¬è¯‘æˆç›®æ ‡çŽ¯å¢ƒå…¼å®¹çš„jsè¯­æ³•
      ]
    }
  ]
]
```

```js
//	é€šè¿‡envè½¬æ¢çš„å‡ ä¸ªdemo

a => a

// è½¬ä¸º
function (a) {return a}

function func (b = false) {return false}
// è½¬ä¸º
function func (b) {
  b = b || false
  return b
}
//	æ¯”è¾ƒæ˜Žæ˜¾ï¼Œä¸Šé¢çš„éƒ½å±žäºŽè½¬æ¢è¯­æ³•ï¼Œæ‰€ä»¥åº”è¯¥è¯´â€œjsæ— è®ºç”¨ä»€ä¹ˆæ–°è¯­æ³•ï¼Œ@babel/preset-envéƒ½èƒ½å¸®ä½ å…¼å®¹åˆ°ç›®æ ‡çŽ¯å¢ƒâ€ã€‚
```



### pluginé…ç½®é¡¹

##### babel-plugin-transform-runtime

`transform-runtime`æ ¸å¿ƒå°±æ˜¯ä¸ºäº†å¯¹`helpers`è¿›è¡Œè‡ªåŠ¨æå–å’Œå…¶å®ƒä¼˜åŒ–ï¼Œæ‰€è°“ä¼˜åŒ–å…¶ä¸­ä¸€ç‚¹å°±æ˜¯é˜²æ­¢é‡å¤å¼•ç”¨ã€‚å¯¹æ¯”ä½¿å®Œå…¨å¼•å…¥ç”¨`babel-polyfill`æ‰“åŒ…åŽçš„ä½“ç§¯å‡å°‘å¾ˆå¤šï¼Œè€Œä¸”ä¸ä¼šæ±¡æŸ“åŽŸç”Ÿçš„å¯¹è±¡ï¼Œé€‚åˆå¼€å‘ç±»åº“

```js
//	npm i -D @babel/plugin-transform-runtime

// .babelrc
{
  "plugins": [
    "@babel/plugin-transform-runtime",
    // é»˜è®¤é…ç½®
      {
        "absoluteRuntime": false,
        "corejs": false,
        "helpers": true,
        "regenerator": true,
        "useESModules": false
      }
  ]
}
```

```js
class Person{}

//åœ¨æ²¡æœ‰ä½¿ç”¨transform-runtimeæ—¶ï¼Œæ¯ä¸ªä½¿ç”¨classå‡½æ•°å¤„ï¼ŒBabel ä¼šç”Ÿæˆclassçš„helperå‡½æ•°æ”¾ç½®åœ¨æ–‡ä»¶é¡¶éƒ¨ï¼Œå°±æ˜¯è¯´åœ¨å¤šä¸ªæ–‡ä»¶é‡Œä½¿ç”¨äº†class, babelå°±ä¼šåœ¨æ¯ä¸ªæ–‡ä»¶é‡Œé¢éƒ½ç”Ÿæˆç›¸åŒçš„helper

"use strict";

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function"); } }

var Person = function Person() {
  _classCallCheck(this, Person);
};
```

```js
//	è¿™æ ·ä¸å¿…è¦çš„é‡å¤ä¼šä½¿æˆ‘ä»¬çš„ä»£ç ä½“ç§¯éžå¸¸é›è‚¿ï¼Œtransform-runtimeå°±æ˜¯æ¥è§£å†³è¿™ä¸ªé‡å¤ç”Ÿæˆhelperçš„é—®é¢˜çš„ï¼Œå®ƒä¼šå°†è¿™ä¸ªes6çš„classè¯­æ³•çš„helperå‡½æ•°æ”¾åœ¨babel-runtime/helpersé‡Œï¼Œç„¶åŽåœ¨ä½¿ç”¨å¤„é€šè¿‡requireå¼•å…¥ï¼Œè¿™æ ·å°±æ²¡å¿…è¦åœ¨æ¯ä¸ªä½¿ç”¨å¤„é‡å¤å®šä¹‰helperäº†ï¼Œè¾¾åˆ°äº†å‡å°‘ä»£ç ä½“ç§¯çš„æ•ˆæžœ

"use strict";

var _classCallCheck2 = require("babel-runtime/helpers/classCallCheck");

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var Person = function Person() {
  (0, _classCallCheck3.default)(this, Person);
};
```



### æ€»ç»“

##### @babel/runtime å¯¹æ¯” babel-polyfill

@babel/runtimeå’Œ@babel/polyfillè¿™ä¸¤ä¸ªæ¨¡å—åŠŸèƒ½å‡ ä¹Žç›¸åŒï¼Œå°±æ˜¯è½¬ç æ–°å¢ž api

- babel-polyfill æ˜¯å½“å‰çŽ¯å¢ƒæ³¨å…¥è¿™äº› es6+ æ ‡å‡†çš„åž«ç‰‡ï¼Œå¥½å¤„æ˜¯å¼•ç”¨ä¸€æ¬¡ï¼Œä¸å†æ‹…å¿ƒå…¼å®¹ï¼Œè€Œä¸”å®ƒå°±æ˜¯å…¨å±€ä¸‹çš„åŒ…ï¼Œä»£ç çš„ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨ã€‚ç¼ºç‚¹ä¹Ÿå¾ˆæ˜Žæ˜¾ï¼Œå®ƒä¼šæ±¡æŸ“åŽŸç”Ÿçš„ä¸€äº›æ–¹æ³•ï¼Œpolyfill æŠŠåŽŸç”Ÿçš„æ–¹æ³•é‡å†™äº†ï¼Œå¦‚æžœå½“å‰é¡¹ç›®å·²ç»æœ‰ä¸€ä¸ª polyfill çš„åŒ…äº†ï¼Œé‚£ä½ åªèƒ½ä¿ç•™å…¶ä¸€ã€‚è€Œä¸”ä¸€æ¬¡æ€§å¼•å…¥è¿™ä¹ˆä¸€ä¸ªåŒ…ï¼Œä¼šå¤§å¤§å¢žåŠ ä½“ç§¯ã€‚å¦‚æžœä½ åªæ˜¯ç”¨å‡ ä¸ªç‰¹æ€§ï¼Œå°±æ²¡å¿…è¦äº†ï¼Œå¦‚æžœä½ æ˜¯å¼€å‘è¾ƒå¤§çš„åº”ç”¨ï¼Œè€Œä¸”ä¼šé¢‘ç¹ä½¿ç”¨æ–°ç‰¹æ€§å¹¶è€ƒè™‘å…¼å®¹ï¼Œé‚£å°±ç›´æŽ¥å¼•å…¥å§ã€‚
- transform-runtime æ˜¯åˆ©ç”¨ plugin è‡ªåŠ¨è¯†åˆ«å¹¶æ›¿æ¢ä»£ç ä¸­çš„æ–°ç‰¹æ€§ï¼Œä½ ä¸éœ€è¦å†å¼•å…¥ï¼Œåªéœ€è¦è£…å¥½ babel-runtime å’Œ é…å¥½ plugin å°±å¯ä»¥äº†ã€‚å¥½å¤„æ˜¯æŒ‰éœ€æ›¿æ¢ï¼Œæ£€æµ‹åˆ°ä½ éœ€è¦å“ªä¸ªï¼Œå°±å¼•å…¥å“ªä¸ª polyfillï¼Œå¦‚æžœåªç”¨äº†ä¸€éƒ¨åˆ†ï¼Œæ‰“åŒ…å®Œçš„æ–‡ä»¶ä½“ç§¯å¯¹æ¯” babel-polyfill ä¼šå°å¾ˆå¤šã€‚è€Œä¸” transform-runtime ä¸ä¼šæ±¡æŸ“åŽŸç”Ÿçš„å¯¹è±¡ï¼Œæ–¹æ³•ï¼Œä¹Ÿä¸ä¼šå¯¹å…¶ä»– polyfill äº§ç”Ÿå½±å“ã€‚æ‰€ä»¥ transform-runtime çš„æ–¹å¼æ›´é€‚åˆå¼€å‘å·¥å…·åŒ…ï¼Œåº“ï¼Œä¸€æ–¹é¢æ˜¯ä½“ç§¯å¤Ÿå°ï¼Œå¦ä¸€æ–¹é¢æ˜¯ç”¨æˆ·ï¼ˆå¼€å‘è€…ï¼‰ä¸ä¼šå› ä¸ºå¼•ç”¨äº†æˆ‘ä»¬çš„å·¥å…·ï¼ŒåŒ…è€Œæ±¡æŸ“äº†å…¨å±€çš„åŽŸç”Ÿæ–¹æ³•ï¼Œäº§ç”Ÿå‰¯ä½œç”¨ï¼Œè¿˜æ˜¯åº”è¯¥ç•™ç»™ç”¨æˆ·è‡ªå·±åŽ»é€‰æ‹©ã€‚ç¼ºç‚¹æ˜¯éšç€åº”ç”¨çš„å¢žå¤§ï¼Œç›¸åŒçš„ polyfill æ¯ä¸ªæ¨¡å—éƒ½è¦åšé‡å¤çš„å·¥ä½œï¼ˆæ£€æµ‹ï¼Œæ›¿æ¢ï¼‰ï¼Œè™½ç„¶ polyfill åªæ˜¯å¼•ç”¨ï¼Œç¼–è¯‘æ•ˆçŽ‡ä¸å¤Ÿé«˜æ•ˆã€‚**å¦å¤–ï¼Œinstance ä¸Šæ–°æ·»åŠ çš„ä¸€äº›æ–¹æ³•ï¼Œbabel-plugin-transform-runtime æ˜¯æ²¡æœ‰åšå¤„ç†çš„ï¼Œæ¯”å¦‚ æ•°ç»„çš„ `includes, filter, fill` ç­‰ï¼Œè¿™ä¸ªç®—æ˜¯ä¸€ä¸ªå…³é”®é—®é¢˜å§ï¼Œç›´æŽ¥æŽ¨èç”¨ polyfillã€‚**
- 

æ ¹æ®å®ƒä»¬ä¸¤çš„ç‰¹ç‚¹ï¼Œ@babel/polyfilä¸€èˆ¬ç”¨äºŽå‰ç«¯é¡¹ç›®ï¼Œ@babel/runtimeä¸€èˆ¬ç”¨æ¥å†™æ’ä»¶



> **ä¸¤ç§æ–¹å¼çš„åŽŸç†ï¼š**

- **babel-polyfillï¼š** ä¸ä¼šå°†ä»£ç ç¼–è¯‘æˆä½Žç‰ˆæœ¬çš„`ECMAScript`ï¼Œå…¶åŽŸç†æ˜¯ï¼šå½“è¿è¡ŒçŽ¯å¢ƒä¸­å¹¶æ²¡æœ‰å®žçŽ°çš„ä¸€äº›æ–¹æ³•ï¼Œ`babel-polyfill`ä¸­ä¼šç»™åšå…¼å®¹ã€‚
- **babel-runtimeï¼š** å°†`es6`ç¼–è¯‘æˆ`es5`åŽ»è¿è¡Œï¼Œå‰ç«¯å¯ä»¥ä½¿ç”¨`es6`çš„è¯­æ³•æ¥å†™ï¼Œæœ€ç»ˆæµè§ˆå™¨ä¸Šè¿è¡Œçš„æ˜¯`es5`ã€‚

> **ä¸¤ç§æ–¹å¼çš„ä¼˜ç¼ºç‚¹ï¼š**

- **babel-polyfillï¼š** é€šè¿‡å‘å…¨å±€å¯¹è±¡å’Œå†…ç½®å¯¹è±¡çš„`prototype`ä¸Šæ·»åŠ æ–¹æ³•æ¥å®žçŽ°ï¼Œæ¯”å¦‚è¿è¡ŒçŽ¯å¢ƒä¸­ä¸æ”¯æŒ`Array-prototype.find`ï¼Œå¼•å…¥`polyfill`ï¼Œå‰ç«¯å°±å¯ä»¥æ”¾å¿ƒçš„åœ¨ä»£ç é‡Œç”¨es6çš„è¯­æ³•æ¥å†™ï¼›ä½†æ˜¯è¿™æ ·ä¼šé€ æˆå…¨å±€ç©ºé—´æ±¡æŸ“ã€‚æ¯”å¦‚åƒ`Array-prototype.find`å°±ä¸å­˜åœ¨äº†ï¼Œè¿˜ä¼šå¼•èµ·ç‰ˆæœ¬ä¹‹å‰çš„å†²çªã€‚ä¸è¿‡å³ä¾¿æ˜¯å¼•å…¥`babel-polyfill`ï¼Œä¹Ÿä¸èƒ½å…¨ç”¨ï¼Œä»£ç é‡æ¯”è¾ƒå¤§ã€‚
- **babel-runtimeï¼š** ä¸ä¼šæ±¡æŸ“å…¨å±€å¯¹è±¡å’Œå†…ç½®çš„å¯¹è±¡åŽŸåž‹ã€‚æ¯”å¦‚å½“å‰è¿è¡ŒçŽ¯å¢ƒä¸æ”¯æŒpromiseï¼Œå¯ä»¥é€šè¿‡å¼•å…¥`babel-runtime/core-js/promise`æ¥èŽ·å–promiseï¼Œæˆ–è€…é€šè¿‡`babel-plugin-transform-runtime`è‡ªåŠ¨é‡å†™ä½ çš„promiseã€‚**ä½†æ˜¯å®ƒä¸ä¼šæ¨¡æ‹Ÿå†…ç½®å¯¹è±¡åŽŸåž‹ä¸Šçš„æ–¹æ³•**ï¼Œæ¯”å¦‚Array-prototype.findï¼Œå°±æ²¡æ³•æ”¯æŒäº†ï¼Œå¦‚æžœè¿è¡ŒçŽ¯å¢ƒä¸æ”¯æŒes6ï¼Œä»£ç é‡Œåˆä½¿ç”¨äº†findæ–¹æ³•ï¼Œå°±ä¼šå‡ºé”™ï¼Œå› ä¸ºes5å¹¶æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ã€‚

> **babel-polyfill ä¸Ž babel-runtime çš„æœ€å¤§åŒºåˆ«åœ¨äºŽï¼šbabel-polyfillæ”¹é€ ç›®æ ‡æµè§ˆå™¨ï¼Œè®©ä½ çš„æµè§ˆå™¨æ‹¥æœ‰æœ¬æ¥ä¸æ”¯æŒçš„ç‰¹æ€§ï¼›babel-runtimeæ”¹é€ ä½ çš„ä»£ç ï¼Œè®©ä½ çš„ä»£ç èƒ½åœ¨æ‰€æœ‰ç›®æ ‡æµè§ˆå™¨ä¸Šè¿è¡Œï¼Œä½†ä¸æ”¹é€ æµè§ˆå™¨ã€‚**



##### vueè„šæ‰‹æž¶ç”Ÿæˆçš„é¡¹ç›®,jså¦‚ä½•å…¼å®¹åˆ°IE9

```js
// .babelrc
{
    "presets": [
      ["env", {
        // è¿™é‡Œé»˜è®¤æ˜¯falseï¼Œä¸ç”¨å†å†™ä¸€é
-        // "modules": false,
        // ä¸€èˆ¬ä¸å•ç‹¬å†™å‡ºæ¥ï¼Œbabel/preset-envä¼šè‡ªä¸ªè¯»å–packageé‡Œé¢çš„browserslistï¼Œä¸Žcsså…¼å®¹çŽ¯å¢ƒä¿æŒä¸€è‡´
        // https://github.com/browserslist/browserslist
-      //  "targets": {
-        //  "browsers": ["> 1%", "last 2 versions", "not ie <= 8"]
-      //  },
      }],
      "stage-2"
    ],
    "plugins": ["transform-vue-jsx", "transform-runtime"]
  }

// webpack.base.conf.js
module.exports = {
  entry: ["@babel/polyfill", "./main.js"],
};
```





| ä½œç”¨                                                         | åç§°                           | å¤‡æ³¨                                                        |
| ------------------------------------------------------------ | ------------------------------ | ----------------------------------------------------------- |
| å…è®¸å‘½ä»¤è¡Œä½¿ç”¨ babel å‘½ä»¤è½¬è¯‘æ–‡ä»¶                            | babel/cli                      | ä¸€èˆ¬åœ¨å†™æ’ä»¶æ—¶ä½¿ç”¨                                          |
| ä¸ºæ‰€æœ‰ API å¢žåŠ å…¼å®¹æ–¹æ³•                                      | babel/polyfill                 | éœ€è¦åœ¨æ‰€æœ‰ä»£ç ä¹‹å‰ requireï¼Œä¸”ä½“ç§¯æ¯”è¾ƒå¤§                    |
| æŠŠå¸®åŠ©ç±»æ–¹æ³•ä»Žæ¯æ¬¡ä½¿ç”¨å‰å®šä¹‰æ”¹ä¸ºç»Ÿä¸€ requireï¼Œç²¾ç®€ä»£ç        | babel/plugin-transform-runtime | ---                                                         |
| helperåº“                                                     | babel/runtime                  | éœ€è¦å®‰è£…ä¸ºä¾èµ–ï¼Œè€Œä¸æ˜¯å¼€å‘ä¾èµ–ï¼ŒnodeçŽ¯å¢ƒä½¿ç”¨ï¼ŒwebçŽ¯å¢ƒä¸éœ€è¦ |
| babelæ’ä»¶åœ¨webpacké¡¹ç›®ä¸­çš„ä¸€ä¸ªå…¥å£                           | babel/loader                   | ---                                                         |
| babelçš„polyfillåº“                                            | babel/core                     | ---                                                         |
| babelé¢„åˆ¶çŽ¯å¢ƒçš„é›†åˆæ’ä»¶ï¼Œé€šè¿‡é…ç½®ç›®æ ‡çŽ¯å¢ƒï¼Œè½¬æ¢æ ‡å‡†ä¸Šçš„æ–°ç‰¹æ€§ | babel/preset-env               | åªè½¬æ–°ç‰¹æ€§ï¼Œä¸è½¬api                                         |
| è½¬æ¢è‰æ¡ˆstage-2ä»¥åŠstage-3é˜¶æ®µçš„çš„æ–°å±žæ€§                     | babel/preset-stage-2           | ---                                                         |





[æŽ˜é‡‘æ ‘é…±]: https://juejin.im/post/6863705400773083149?utm_source=gold_browser_extension#heading-1
[babelä¸­æ–‡ç½‘]: https://www.babeljs.cn/docs/

